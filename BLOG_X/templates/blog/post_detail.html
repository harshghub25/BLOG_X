{% extends 'base.html' %}
{% block content %}
<article>
  <h2>{{ object.title }}</h2>
  <p class="text-muted">By {{ object.author }} on {{ object.created|date:'M d, Y' }}</p>
  {% if object.cover %}<img src='{{ object.cover.url }}' class='img-fluid mb-3'>{% endif %}
  <div>{{ object.content|linebreaks }}</div>
  <p><a href="{% url 'post_like' object.slug %}">Like/Unlike</a> ({{ object.likes_count }})</p>
  <hr>
  <h5>Comments ({{ object.comments.count }})</h5>
  {% for c in object.comments.all %}
    <div class="card mb-2"><div class="card-body">
      <p><strong>{{ c.author }}</strong> <small>{{ c.created|date:'M d, Y H:i' }}</small></p>
      <p>{{ c.body }}</p>
    </div></div>
  {% empty %}<p>No comments</p>{% endfor %}
  {% if user.is_authenticated %}
  <form method="post" action="{% url 'post_detail' object.slug %}#add-comment">{% csrf_token %}
    <div class="mb-2"><textarea name="body" class="form-control" required></textarea></div>
    <button class="btn btn-primary">Add comment</button>
  </form>
  {% else %}<p><a href="{% url 'login' %}">Login</a> to comment.</p>{% endif %}
</article>
{% endblock %}
